{smcl}
{com}{sf}{ul off}{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}C:\Sync\OneDrive - The University of the West Indies\repo_datagroup\repo_test/ipolate_002.smcl
  {txt}log type:  {res}smcl
 {txt}opened on:  {res}17 Jun 2018, 08:19:45
{txt}
{com}. 
. **  GENERAL DO-FILE COMMENTS
. //  program:      ipolate_001.do
. //  project:      Ipolate missing data
. //  author:       HAMBLETON \ 16-JUL-2017
. 
. ** DO-FILE SET UP COMMANDS
. version 15
{txt}
{com}. clear all
{res}{txt}
{com}. macro drop _all
{txt}
{com}. set more 1
{txt}
{com}. set linesize 80
{txt}
{com}. 
. ** Load dataset
. use ageadjustedrates.dta, clear
{txt}
{com}. 
. ** Numeric for country
. egen cid = group(country)
{txt}
{com}. labmask cid, values(country)
{txt}
{com}. label var cid "Internal country ID"
{txt}
{com}. drop country
{txt}
{com}. order cid
{txt}
{com}. 
. ** Example usng Antigua
. keep if cid==2 & sex==1
{txt}(1,148 observations deleted)

{com}. 
. ** Register missing as missing
. mvdecode actual , mv(0=.)
      {txt}actual:{res}{col 15}7{txt} missing values generated

{com}. 
. ** METHOD 1
. ** Fillin missing using ipolate
. ipolate actual year , gen(rate_f1)
{txt}(5 missing values generated)

{com}. order rate_f1, after(actual)
{txt}
{com}. label var rate_f1 "Rate with filled values: method 1"
{txt}
{com}. 
. ** METHOD 2
. ** Fillin missing using lowess smoothing
. lowess actual year , gen(rate_t1) bw(0.5) nogr
{txt}
{com}. ipolate rate_t1 year , gen(rate_f2)
{txt}(5 missing values generated)

{com}. drop rate_t1
{txt}
{com}. order rate_f2, after(rate_f1)
{txt}
{com}. label var rate_f2 "Rate with filled values: method 2"
{txt}
{com}. 
. ** METHOD 3
. ** Fillin missing using robust nonlinear smoother
. smooth 3rssh,twice rate_f1, gen(rate_f3)
{txt}
{com}. *ipolate rate_t1 year , gen(rate_f2) epolate
. order rate_f3, after(rate_f2)
{txt}
{com}. label var rate_f3 "Rate with filled values: method 3"
{txt}
{com}. 
. ** Plot the resulting graph for Barbados
. gr twoway line rate_f2 rate_f3 year if cid==2
{res}{txt}
{com}. 
{txt}end of do-file

{com}. 